<!DOCTYPE html>
<html lang="uk">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FastFood • Кошик</title>
    <link rel="icon" type="image/ico" href="/favicon.ico">
    <link rel="stylesheet" href="/css/Global.css">
    <link rel="stylesheet" href="/css/order-page.css">
</head>

<body>
<main id="order-page">
    <a href="/cart" class="btn btn-outline"><span><-</span>Назад</a>

    <h1 class="text-primary">Замовлення №</h1>

    <div id="order-card" class="order-card bg-white"></div>

    <div id="receipt">
        <table>
            <tr>
                <th colspan="2"><h3 class="text-white">Інформація про платіж</h3></th>
            </tr>
            <tr>
                <td class="body-text text-background">Ім’я отримувача</td>
                <td id="receivers-name" class="body-text text-background text-to-right"></td>
            </tr>
            <tr>
                <td class="body-text text-background">Електронна пошта замовника</td>
                <td id="receivers-email" class="body-text text-background text-to-right"></td>
            </tr>
            <tr>
                <td class="body-text text-background">Адреса отримувача</td>
                <td id="receivers-address" class="body-text text-background text-to-right"></td>
            </tr>
            <tr>
                <td class="body-text text-background">Спосіб оплати</td>
                <td id="receivers-card" class="body-text text-background text-to-right"></td>
            </tr>
            <tr id="comment-row">
                <td class="body-text text-background">Коментар</td>
                <td id="comment" class="body-text text-background text-to-right"></td>
            </tr>
            <tr>
                <td class="body-text text-background">Вартість продуктів</td>
                <td id="items-cost" class="body-text text-background text-to-right"></td>
            </tr>
            <tr>
                <td class="body-text text-background">Вартість доставки</td>
                <td id="delivery-cost" class="body-text text-background text-to-right"></td>
            </tr>
        </table>

        <div class="horizontal-rule"></div>

        <h3 id="total" class="text-white">Усього: 0₴</h3>
    </div>

    <h2 class="text-primary">Ваше замовлення</h2>
    <div id="items"></div>
</main>

<footer>
    <p class="copyright text-primary">&copy; FastFood 2017-2025. Всі права захищені.</p>
    <a href="#" class="text-link">↑ До гори</a>
</footer>

<script src="/js/database.js"></script>
<script src="/js/cart.js"></script>
<script src="/js/order.js"></script>
<script src="/js/load-orders.js"></script>
<script src="/js/script.js"></script>

<script>

    // Get ID from URL
    const urlParams = new URLSearchParams(window.location.search);
    const orderId = urlParams.get('id');
    const order = orderId ? loadOrderByID(orderId) : null;

    if (order) {
        document.querySelector('h1').innerText = `Замовлення №${orderId}`;

        document.getElementById("order-card").innerHTML = createOrderProgressCard(orderId, order.placed_at).innerHTML;

        document.getElementById("receivers-name").innerText = order.receiver.name;
        document.getElementById("receivers-email").innerText = order.receiver.email;
        document.getElementById("receivers-address").innerText = order.receiver.address;
        document.getElementById("receivers-card").innerText = `Карта, ...${order.receiver.card_l4d}`;

        const comment = order.comment.trim();
        if (comment) {
            document.getElementById("comment").innerText = `${order.comment}`;
        } else {
            document.getElementById("comment-row").remove();
        }

        document.getElementById("items-cost").innerText = `${order.total}₴`;
        document.getElementById("delivery-cost").innerText = `${order.delivery_cost}₴`;
        document.getElementById("total").innerText = `Усього: ${order.total + order.delivery_cost}₴`;

        const items = order.items;
        Object.keys(items).forEach(item => {
            let product = PRODUCT_TABLE[item];
            product.price = items[item].p;
            document.getElementById("items").appendChild(createInCartCard(item, product, items[item].q, false));
        })

        updateOrderStages(orderId)
    }

</script>

</body>
</html>